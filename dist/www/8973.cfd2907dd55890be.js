"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8973],{8973:(h,g,r)=>{r.r(g),r.d(g,{ChangePasswordPageModule:()=>Z});var l=r(9808),o=r(2382),m=r(8058),u=r(7614),a=r(655),e=r(4893),i=r(8876),p=r(4465),f=r(5219),w=r(7556);function v(t,d){if(1&t&&(e.TgZ(0,"span",4),e._uU(1),e.qZA()),2&t){const s=e.oxw();e.xp6(1),e.hij("\xa0-\xa0",s.user.username,"")}}function P(t,d){1&t&&(e.TgZ(0,"span"),e._uU(1,"Password must be at least 8 characters length"),e.qZA())}function b(t,d){1&t&&(e.TgZ(0,"span"),e._uU(1,"Password must be at least 8 characters length"),e.qZA())}function x(t,d){1&t&&e._uU(0,"This field is invalid")}const y=[{path:"",component:(()=>{class t{constructor(s,n,c,T,A,F,I){this.activatedRoute=s,this.sqlService=n,this.fb=c,this.toast=T,this.router=A,this.loading=F,this.authService=I,this.userForm=this.fb.nonNullable.group({currentPassword:this.fb.nonNullable.control("",{validators:[o.kI.required,o.kI.minLength(8)]}),newPassword:this.fb.nonNullable.control("",{validators:[o.kI.required,o.kI.minLength(8)]})})}ngOnInit(){this.initializeUser()}initializeUser(){return(0,a.mG)(this,void 0,void 0,function*(){try{const s=this.activatedRoute.snapshot.params.id,n=yield this.sqlService.table("user").row(s).get();this.user=n}catch(s){this.toast.presentError(s)}})}onSubmit(){return(0,a.mG)(this,void 0,void 0,function*(){if(this.userForm.invalid)return this.userForm.markAsDirty(),this.userForm.markAllAsTouched(),void this.userForm.updateValueAndValidity();const s=this.loading.create();try{if(!this.user)throw"Sorry, something went wrong";const n=this.userForm.getRawValue();yield this.authService.changePassword(this.user.username,n.currentPassword,n.newPassword),yield this.router.navigate(["../"],{relativeTo:this.activatedRoute}),yield s.hide(),this.toast.present("Password updated")}catch(n){yield s.hide(),this.toast.presentError(n)}})}}return t.\u0275fac=function(s){return new(s||t)(e.Y36(u.gz),e.Y36(i.a),e.Y36(o.qu),e.Y36(p.k),e.Y36(u.F0),e.Y36(f.b),e.Y36(w.e))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-change-password"]],decls:35,vars:6,consts:[[1,"bg-info","border-bottom"],[1,"px-xl-5","px-4"],[1,"d-flex","flex-wrap","align-items-center","px-xl-5","pt-5"],["href","/",1,"d-flex","align-items-center","mb-0","me-auto","text-dark","text-decoration-none","lh-1"],[1,"fs-2-large","text-primary","fw-bold","text-light"],["class","fs-2-large text-primary  fw-bold text-light",4,"ngIf"],[1,"px-xl-5","pt-3","pb-3","d-flex","justify-content-between","align-items-start"],["type","button","routerLink","../",1,"btn","btn-sm","btn-link","d-flex","align-items-center","text-decoration-none","text-info","ps-0","text-light"],[1,"material-icons","fs-3","me-2"],[1,"fs-5"],["novalidate","",1,"px-xl-5","mt-4",3,"formGroup"],[1,"row","g-3"],[1,"col-12"],["for","username","fs-5-small","",1,"form-label","fs-5","mb-1"],[1,"input-group","has-validation"],["type","password","formControlName","currentPassword","required","","autocomplete","current-password",1,"form-control","py-2","rounded-3"],[1,"invalid-feedback","mt-1","fs-5"],[4,"ngIf","ngIfElse"],[1,"row","g-3","mt-3"],["type","password","formControlName","newPassword","required","","autocomplete","new-password",1,"form-control","py-2","rounded-3"],["type","submit",1,"rounded-3","px-4","py-2","btn","btn-info","mt-5",3,"click"],["defaultErrorLabelState",""]],template:function(s,n){if(1&s&&(e.TgZ(0,"header",0)(1,"div",1)(2,"section",2)(3,"a",3)(4,"span",4),e._uU(5,"Change password"),e.qZA(),e.YNc(6,v,2,1,"span",5),e.qZA()(),e.TgZ(7,"section",6)(8,"button",7)(9,"span",8),e._uU(10,"arrow_back"),e.qZA(),e.TgZ(11,"span",9),e._uU(12,"Back"),e.qZA()()()()(),e.TgZ(13,"main",1)(14,"form",10)(15,"div",11)(16,"div",12)(17,"label",13),e._uU(18,"Current password"),e.qZA(),e.TgZ(19,"div",14),e._UZ(20,"input",15),e.TgZ(21,"div",16),e.YNc(22,P,2,0,"span",17),e.qZA()()()(),e.TgZ(23,"div",18)(24,"div",12)(25,"label",13),e._uU(26,"New password"),e.qZA(),e.TgZ(27,"div",14),e._UZ(28,"input",19),e.TgZ(29,"div",16),e.YNc(30,b,2,0,"span",17),e.qZA()()()(),e.TgZ(31,"button",20),e.NdJ("click",function(){return n.onSubmit()}),e._uU(32,"Change password"),e.qZA()()(),e.YNc(33,x,1,0,"ng-template",null,21,e.W1O)),2&s){const c=e.MAs(34);e.xp6(6),e.Q6J("ngIf",n.user),e.xp6(8),e.Q6J("formGroup",n.userForm),e.xp6(8),e.Q6J("ngIf",n.userForm.controls.currentPassword.errors&&n.userForm.controls.currentPassword.errors.minlength)("ngIfElse",c),e.xp6(8),e.Q6J("ngIf",n.userForm.controls.newPassword.errors&&n.userForm.controls.newPassword.errors.minlength)("ngIfElse",c)}},dependencies:[l.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,m.YI,u.rH],styles:["form[_ngcontent-%COMP%]{max-width:500px}input[_ngcontent-%COMP%]{min-height:48px}"]}),t})()}];let C=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(y),u.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.ez,o.u5,o.UX,m.Pc,C]}),t})()},5219:(h,g,r)=>{r.d(g,{b:()=>u});var l=r(4893);let o=(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=l.Xpm({type:a,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"p-3","loading-dots"]],template:function(i,p){1&i&&(l.TgZ(0,"div",0),l._uU(1,"Please wait"),l.qZA())}}),a})();var m=r(3500);let u=(()=>{class a{constructor(i){this.modalService=i}create(){const i=this.modalService.show(o,{class:"modal-sm",backdrop:"static",keyboard:!1,animated:!1});return Object.assign(Object.assign({},i),{hide:()=>new Promise(p=>{setTimeout(()=>{i.hide(),p()},300)})})}}return a.\u0275fac=function(i){return new(i||a)(l.LFG(m.tT))},a.\u0275prov=l.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()}}]);