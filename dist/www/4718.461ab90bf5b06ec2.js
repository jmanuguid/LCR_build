"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4718],{4718:(A,x,a)=>{a.r(x),a.d(x,{AuditLogsPageModule:()=>z});var d=a(9808),h=a(2382),T=a(8058),f=a(7614),v=a(1065),t=a(4893);let b=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-header"]],decls:9,vars:0,consts:[[1,"bg-info","border-bottom"],[1,"wrapper","px-xl-5","px-4"],[1,"d-flex","flex-wrap","align-items-center","px-xl-5","pt-5"],[1,"d-flex","align-items-center","mb-0","me-auto","text-dark","text-decoration-none","lh-1"],[1,"fs-2-large","text-primary","fw-bold","text-light"],[1,"px-xl-5","pt-3","pb-3","d-flex","justify-content-between","align-items-start"],[1,"text-white-50"]],template:function(e,o){1&e&&(t.TgZ(0,"header",0)(1,"div",1)(2,"section",2)(3,"a",3)(4,"span",4),t._uU(5,"Audit logs"),t.qZA()()(),t.TgZ(6,"section",5)(7,"span",6),t._uU(8,"Track users activity logs"),t.qZA()()()())}}),n})();var l=a(655),c=a(8372),m=a(8505),g=a(3905),_=a(7391),P=a(8876),p=a(4465);let y=(()=>{class n{constructor(e){this.el=e}onClick(e){this.el.nativeElement.classList.toggle("text-nowrap")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq))},n.\u0275dir=t.lG2({type:n,selectors:[["","appTextWrapToggle",""]],hostBindings:function(e,o){1&e&&t.NdJ("click",function(s){return o.onClick(s.target)})}}),n})();function O(n,i){1&n&&(t.TgZ(0,"div",13)(1,"div",25)(2,"i"),t._uU(3,"\u2014 No records found \u2014"),t.qZA()()())}function q(n,i){1&n&&(t.TgZ(0,"div",13)(1,"div",25)(2,"i",26),t._uU(3,"Please wait"),t.qZA()()())}function w(n,i){1&n&&(t.TgZ(0,"div",27)(1,"div",28)(2,"i",26),t._uU(3,"Please wait"),t.qZA()()())}function U(n,i){if(1&n&&(t.TgZ(0,"div",30)(1,"div",31),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"div",32),t._uU(5),t.qZA(),t.TgZ(6,"div",33),t._uU(7),t.qZA(),t.TgZ(8,"div",33),t._uU(9),t.qZA()()),2&n){const e=i.$implicit;t.xp6(2),t.Oqu(t.xi3(3,4,e.datetime,"short")),t.xp6(3),t.Oqu(e.summary),t.xp6(2),t.Oqu(e.ipAddress),t.xp6(2),t.Oqu(e.user)}}function M(n,i){if(1&n&&(t.ynx(0),t.YNc(1,U,10,7,"div",29),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.records)}}function N(n,i){1&n&&t.GkF(0)}function L(n,i){if(1&n&&(t.ynx(0),t.YNc(1,M,2,1,"ng-container",20),t.YNc(2,N,1,0,"ng-container",20),t.BQk()),2&n){const e=t.oxw(),o=t.MAs(43),r=t.MAs(47);t.xp6(1),t.Q6J("ngIf",e.records.length>0)("ngIfElse",o),t.xp6(1),t.Q6J("ngIf",!e.fetching)("ngIfElse",r)}}let S=(()=>{class n{constructor(e,o,r,s,u){this.sqlService=e,this.toast=o,this.router=r,this.fb=s,this.activatedRoute=u,this.searchControl=this.fb.nonNullable.control(""),this.hasNext=!1,this.hasPrevious=!1,this.fetching=!1}ngOnInit(){this.initializeSearchControl(),this.initializeQueryParams()}ngOnDestroy(){_.c.unsubscribe(this.searchControlSubscription,this.queryParamsSubscription)}initializeSearchControl(){this.searchControlSubscription=this.searchControl.valueChanges.pipe((0,c.b)(1e3),(0,m.b)(e=>{this.router.navigate([],{queryParams:{search:e||void 0},queryParamsHandling:"merge"})})).subscribe()}initializeQueryParams(){this.activatedRoute.queryParams.pipe((0,m.b)(e=>{e.search?this.searchRecords():this.initializeRecords()})).subscribe()}initializeRecords(){return(0,l.mG)(this,void 0,void 0,function*(){this.fetching=!0;try{const e=yield(0,g.z)(this.activatedRoute.queryParams),o=e.limit,r=o?Number(o):10,s=e.offset,C=(s?Number(s):0)*r,Z=yield this.sqlService.table("audit").ref.limit(r+1).offset(C).get();this.records=Z.filter((B,D)=>D<r),this.hasNext=Z.length>r,this.hasPrevious=C>0,this.fetching=!1}catch(e){this.fetching=!1,this.toast.presentError(e)}})}searchRecords(){return(0,l.mG)(this,void 0,void 0,function*(){this.fetching=!0;try{const e=yield(0,g.z)(this.activatedRoute.queryParams),o=e.search,r=e.limit,s=r?Number(r):10,u=yield this.sqlService.table("audit").ref.search(o).limit(s).get();this.fetching=!1,this.records=u}catch(e){this.fetching=!1,this.toast.presentError(e)}})}onSearchByOptionChange(e){this.router.navigate([],{queryParams:{searchBy:e},queryParamsHandling:"merge"}),this.searchBy=null!=e?e:"name"}onLimitOptionChange(e){this.router.navigate([],{queryParams:{limit:e}}),this.limit=null!=e?e:"10"}next(){return(0,l.mG)(this,void 0,void 0,function*(){const o=(yield(0,g.z)(this.activatedRoute.queryParams)).offset,s=(o?Number(o):0)+1,u=Math.max(0,s);this.router.navigate([],{queryParams:{offset:u},queryParamsHandling:"merge"})})}previous(){return(0,l.mG)(this,void 0,void 0,function*(){const o=(yield(0,g.z)(this.activatedRoute.queryParams)).offset,s=(o?Number(o):0)-1,u=Math.max(0,s);this.router.navigate([],{queryParams:{offset:0===u?void 0:u},queryParamsHandling:"merge"})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(P.a),t.Y36(p.k),t.Y36(f.F0),t.Y36(h.qu),t.Y36(f.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-content"]],decls:60,vars:6,consts:[[1,"px-xl-5","my-5"],[1,"px-xl-5","px-4"],[1,"d-flex","align-items-center","flex-column","gap-xl-4"],[1,"ms-auto","d-flex","align-items-center","gap-3"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","d-flex","align-items-center","border-0","pe-0"],[1,"fs-5",3,"ngSwitch"],[1,"text-secondary","me-2","fw-light"],[1,"material-icons"],[1,"dropdown-menu"],[1,"px-3","pb-2","m-0","fs-5-small","text-secondary","border-bottom"],["role","button",1,"dropdown-item",3,"click"],[1,"table","mt-4","container","p-0"],[1,"header","row","m-0"],[1,"header","border-bottom","col-auto","datetime-col","px-1","lh-xl","fs-5-small","text-secondary","fw-semibold","text-nowrap","text-truncate"],[1,"header","border-bottom","col","px-1","lh-xl","fs-5-small","text-secondary","fw-semibold","text-nowrap","text-truncate"],[1,"header","border-bottom","col-auto","user-col","px-1","lh-xl","fs-5-small","text-secondary","fw-semibold","text-nowrap","text-truncate"],["emptyState",""],["loadingState",""],["partialLoadingState",""],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center","gap-3"],["type","button",1,"btn","btn-sm","d-flex","align-items-center","border-0","text-decoration-none","text-info","ps-0",3,"disabled","click"],[1,"material-icons","fs-3","me-2"],[1,"fs-5"],[1,"col-12","px-1","lh-xl","text-secondary","text-center","p-5"],[1,"loading-dots"],[1,"header","row","m-0","mt-3"],[1,"col-12","px-1","lh-xl","text-secondary","text-center","px-5"],["class","row m-0 text-nowrap","appTextWrapToggle","",4,"ngFor","ngForOf"],["appTextWrapToggle","",1,"row","m-0","text-nowrap"],[1,"text-truncate","col-auto","datetime-col","border-bottom","px-1","py-2","fs-5"],[1,"text-truncate","col","border-bottom","px-1","py-2","fs-5"],[1,"text-truncate","col-auto","user-col","border-bottom","px-1","py-2","fs-5"]],template:function(e,o){if(1&e&&(t.TgZ(0,"main",0)(1,"main",1)(2,"header",2)(3,"aside",3)(4,"div",4)(5,"button",5)(6,"span",6)(7,"span",7),t._uU(8,"Rows per page:"),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA()(),t.TgZ(11,"span",8),t._uU(12,"arrow_drop_down"),t.qZA()(),t.TgZ(13,"ul",9)(14,"p",10),t._uU(15,"Limit"),t.qZA(),t.TgZ(16,"li")(17,"a",11),t.NdJ("click",function(){return o.onLimitOptionChange("1")}),t._uU(18,"1"),t.qZA()(),t.TgZ(19,"li")(20,"a",11),t.NdJ("click",function(){return o.onLimitOptionChange()}),t._uU(21,"10"),t.qZA()(),t.TgZ(22,"li")(23,"a",11),t.NdJ("click",function(){return o.onLimitOptionChange("20")}),t._uU(24,"20"),t.qZA()(),t.TgZ(25,"li")(26,"a",11),t.NdJ("click",function(){return o.onLimitOptionChange("50")}),t._uU(27,"50"),t.qZA()(),t.TgZ(28,"li")(29,"a",11),t.NdJ("click",function(){return o.onLimitOptionChange("100")}),t._uU(30,"100"),t.qZA()()()()()(),t.ynx(31),t.TgZ(32,"div",12)(33,"div",13)(34,"div",14),t._uU(35,"Timestamp"),t.qZA(),t.TgZ(36,"div",15),t._uU(37,"Summary"),t.qZA(),t.TgZ(38,"div",16),t._uU(39,"IP address"),t.qZA(),t.TgZ(40,"div",16),t._uU(41,"User"),t.qZA()(),t.YNc(42,O,4,0,"ng-template",null,17,t.W1O),t.YNc(44,q,4,0,"ng-template",null,18,t.W1O),t.YNc(46,w,4,0,"ng-template",null,19,t.W1O),t.YNc(48,L,3,4,"ng-container",20),t.qZA(),t.TgZ(49,"div",21)(50,"button",22),t.NdJ("click",function(){return o.previous()}),t.TgZ(51,"span",23),t._uU(52,"arrow_back"),t.qZA(),t.TgZ(53,"span",24),t._uU(54,"Previous"),t.qZA()(),t.TgZ(55,"button",22),t.NdJ("click",function(){return o.next()}),t.TgZ(56,"span",24),t._uU(57,"Next"),t.qZA(),t.TgZ(58,"span",23),t._uU(59,"arrow_forward"),t.qZA()()(),t.BQk(),t.qZA()()),2&e){const r=t.MAs(45);t.xp6(6),t.Q6J("ngSwitch",o.searchBy),t.xp6(4),t.Oqu(o.limit||10),t.xp6(38),t.Q6J("ngIf",o.records)("ngIfElse",r),t.xp6(2),t.Q6J("disabled",o.fetching||!o.hasPrevious),t.xp6(5),t.Q6J("disabled",o.fetching||!o.hasNext)}},dependencies:[d.sg,d.O5,d.RF,y,d.uU],styles:[".row[_ngcontent-%COMP%]:not(.header){cursor:pointer}.row[_ngcontent-%COMP%]:not(.header):hover{background-color:rgba(0,0,0,.05)}.border-bottom[_ngcontent-%COMP%]:not(.header){border-color:rgba(0,0,0,.075)!important}.table[_ngcontent-%COMP%]{min-height:250px}button[_ngcontent-%COMP%]:disabled{color:var(--bs-secondary)!important}.datetime-col[_ngcontent-%COMP%], .user-col[_ngcontent-%COMP%]{width:12rem}.row[_ngcontent-%COMP%]{line-break:anywhere}.col-auto[_ngcontent-%COMP%], .col[_ngcontent-%COMP%], .col-auto[_ngcontent-%COMP%]{white-space:inherit}"]}),n})();const R=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-audit-logs"]],decls:2,vars:0,template:function(e,o){1&e&&t._UZ(0,"app-header")(1,"app-content")},dependencies:[b,S]}),n})(),canActivate:[v.E]}];let k=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[f.Bz.forChild(R),f.Bz]}),n})();var J=a(5503);let E=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez]}),n})(),z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,h.u5,h.UX,T.Pc,k,J.D,E]}),n})()},8372:(A,x,a)=>{a.d(x,{b:()=>f});var d=a(4986),h=a(4482),T=a(5403);function f(v,t=d.z){return(0,h.e)((b,l)=>{let c=null,m=null,g=null;const _=()=>{if(c){c.unsubscribe(),c=null;const p=m;m=null,l.next(p)}};function P(){const p=g+v,y=t.now();if(y<p)return c=this.schedule(void 0,p-y),void l.add(c);_()}b.subscribe((0,T.x)(l,p=>{m=p,g=t.now(),c||(c=t.schedule(P,v),l.add(c))},()=>{_(),l.complete()},void 0,()=>{m=c=null}))})}}}]);